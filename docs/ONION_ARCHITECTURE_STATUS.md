# ะกัะฐััั ะผะธะณัะฐัะธะธ ะฝะฐ Onion Architecture

## โ ะะธะณัะฐัะธั ะทะฐะฒะตััะตะฝะฐ ะฟะพะปะฝะพัััั!

### 1. ะะพะผะตะฝะฝัะน ัะปะพะน (Domain Layer) - ะฆะตะฝัั ะฐััะธัะตะบัััั
- โ `internal/domain/entity/user.go` - ะดะพะผะตะฝะฝะฐั ัััะฝะพััั User
- โ `internal/domain/entity/report.go` - ะดะพะผะตะฝะฝะฐั ัััะฝะพััั Report  
- โ `internal/domain/entity/competition.go` - ะดะพะผะตะฝะฝะฐั ัััะฝะพััั Competition (ัะฐััะธัะตะฝะฐ ะฒัะตะผะธ ะฟะพะปัะผะธ)

**ะฅะฐัะฐะบัะตัะธััะธะบะฐ**: ะะพะผะตะฝะฝัะต ัััะฝะพััะธ ะฝะต ะทะฐะฒะธััั ะฝะธ ะพั ัะตะณะพ - ััะพ ัะธัััะน ัะตะฝัั Onion Architecture.

### 2. ะะฝัะตััะตะนัั ัะตะฟะพะทะธัะพัะธะตะฒ (Repository Interfaces)
- โ `internal/repository/interface/user_repository.go` - ะธะฝัะตััะตะนั UserRepository
- โ `internal/repository/interface/report_repository.go` - ะธะฝัะตััะตะนั ReportRepository
- โ `internal/repository/interface/competition_repository.go` - ะธะฝัะตััะตะนั CompetitionRepository

**ะฅะฐัะฐะบัะตัะธััะธะบะฐ**: ะะฝัะตััะตะนัั ะพะฟัะตะดะตะปะตะฝั ะฒ domain ัะปะพะต ะธ ะฝะต ะทะฐะฒะธััั ะพั ะธะฝััะฐััััะบัััั.

### 3. ะะตะฐะปะธะทะฐัะธั ัะตะฟะพะทะธัะพัะธะตะฒ (Infrastructure Layer)
- โ `internal/repository/mongodb/user_repository.go` - ัะตะฐะปะธะทัะตั ะธะฝัะตััะตะนั UserRepository
- โ `internal/repository/mongodb/report_repository.go` - ัะตะฐะปะธะทัะตั ะธะฝัะตััะตะนั ReportRepository
- โ `internal/repository/mongodb/competition_repository.go` - ัะตะฐะปะธะทัะตั ะธะฝัะตััะตะนั CompetitionRepository

**ะฅะฐัะฐะบัะตัะธััะธะบะฐ**: 
- ะะตะฟะพะทะธัะพัะธะธ ัะตะฐะปะธะทััั ะธะฝัะตััะตะนัั (Dependency Inversion)
- ะะพะฝะฒะตััะธัััั ะผะตะถะดั ะดะพะผะตะฝะฝัะผะธ ัััะฝะพัััะผะธ ะธ MongoDB ะดะพะบัะผะตะฝัะฐะผะธ
- ะัะต ะผะตัะพะดั ัะฐะฑะพัะฐัั ั entity ัะธะฟะฐะผะธ

### 4. ะกะปะพะน ะฟัะธะปะพะถะตะฝะธั (Application Layer)
- โ `internal/usecase/base.go` - ะธะฝัะตััะตะนั UseCase
- โ `internal/usecase/usecase.go` - ัะตะฐะปะธะทะฐัะธั UseCaseImpl

**ะฅะฐัะฐะบัะตัะธััะธะบะฐ**:
- UseCase ะทะฐะฒะธัะธั ัะพะปัะบะพ ะพั ะธะฝัะตััะตะนัะพะฒ ัะตะฟะพะทะธัะพัะธะตะฒ (ะฝะต ะพั ะบะพะฝะบัะตัะฝัั ัะตะฐะปะธะทะฐัะธะน)
- ะัะฟะพะปัะทัะตั ะดะพะผะตะฝะฝัะต ัััะฝะพััะธ ะดะปั ะฑะธะทะฝะตั-ะปะพะณะธะบะธ
- โ **ะัะต ะผะตัะพะดั ะฟะพะปะฝะพัััั ัะตะฐะปะธะทะพะฒะฐะฝั** (Auth, User, Reports, Competitions, Admin)

### 5. ะกะปะพะน ะฟัะตะดััะฐะฒะปะตะฝะธั (Presentation Layer)
- โ `graph/resolver/resolver.go` - ะธัะฟะพะปัะทัะตั ัะพะปัะบะพ UseCase
- โ `graph/resolver/converters.go` - ััะฝะบัะธะธ ัะพัะผะฐัะธัะพะฒะฐะฝะธั entity โ GraphQL (ะธัะฟะพะปัะทััััั ะฒ UseCase)
- โ `graph/resolver/schema.resolvers.go` - ะฒัะต resolver'ั ะธัะฟะพะปัะทััั UseCase
- โ `cmd/graph/server.go` - ะฟัะฐะฒะธะปัะฝะฐั ะธะฝะธัะธะฐะปะธะทะฐัะธั ะทะฐะฒะธัะธะผะพััะตะน

**ะฅะฐัะฐะบัะตัะธััะธะบะฐ**:
- โ **ะัะต resolver'ั ะธัะฟะพะปัะทััั ัะพะปัะบะพ UseCase** (ะฝะต ัะตะฟะพะทะธัะพัะธะธ ะฝะฐะฟััะผัั)
- โ ะัะต resolver'ั ัะฐะฑะพัะฐัั ัะตัะตะท Application ัะปะพะน
- โ ะะตะฟะพะทะธัะพัะธะธ ัะดะฐะปะตะฝั ะธะท ััััะบัััั Resolver
- โ ะะพะฝะฒะตััะตัั entity โ GraphQL ะธัะฟะพะปัะทััััั ะฒ UseCase

## ๐ ะขะตะบััะฐั ะฐััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Presentation (graph/resolver)          โ
โ  โ ะัะฟะพะปัะทัะตั ัะพะปัะบะพ UseCase           โ
โ  โ ะะพะฝะฒะตััะธััะตั GraphQL โ UseCase      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ depends on (ะฟัะฐะฒะธะปัะฝะพ)
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Application (internal/usecase)        โ
โ  โ ะัะต ะผะตัะพะดั ัะตะฐะปะธะทะพะฒะฐะฝั             โ
โ  โ ะัะฟะพะปัะทัะตั ะธะฝัะตััะตะนัั               โ
โ  โ ะะฐะฑะพัะฐะตั ั domain entities          โ
โ  โ ะะพะฝะฒะตััะธััะตั entity โ GraphQL       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ depends on (ะฟัะฐะฒะธะปัะฝะพ)
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Domain (internal/domain/entity)        โ
โ  โ ะงะธัััะต ัััะฝะพััะธ                     โ
โ  โ ะะต ะทะฐะฒะธััั ะฝะธ ะพั ัะตะณะพ               โ
โ  โ Competition ัะฐััะธัะตะฝะฐ ะฒัะตะผะธ ะฟะพะปัะผะธ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โฒ implements (ะฟัะฐะฒะธะปัะฝะพ)
           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Infrastructure (internal/repository)   โ
โ  โ ะะตะฐะปะธะทัะตั ะธะฝัะตััะตะนัั                โ
โ  โ ะะพะฝะฒะตััะธััะตั entity โ MongoDB       โ
โ  โ ะัะต ะผะตัะพะดั ัะฐะฑะพัะฐัั ั entity       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## โ ะงัะพ ัะฐะฑะพัะฐะตั ะฟัะฐะฒะธะปัะฝะพ

### 1. ะัะต ะผะตัะพะดั UseCase ัะตะฐะปะธะทะพะฒะฐะฝั
- โ **Auth**: `Register`, `Login`, `Logout`
- โ **User**: `GetCurrentUser`, `UpdateProfile`, `UpdatePassword`
- โ **Reports**: `GetReports`, `GetReport`, `CreateReport`, `UpdateReport`, `DeleteReport`
- โ **Competitions**: `GetCompetitions`, `GetCompetition`, `CreateCompetition`, `UpdateCompetition`, `DeleteCompetition`
- โ **Admin**: `GetAdminUsers`, `GetAdminUser`, `AdminUpdateUser`, `AdminDeleteUser`

### 2. ะัะต Resolver'ั ะธัะฟะพะปัะทััั UseCase
- โ ะัะต Mutation resolver'ั ะธัะฟะพะปัะทััั `r.useCase`
- โ ะัะต Query resolver'ั ะธัะฟะพะปัะทััั `r.useCase`
- โ ะะตั ะฟััะผัั ะฒัะทะพะฒะพะฒ ัะตะฟะพะทะธัะพัะธะตะฒ ะธะท Resolver'ะพะฒ

### 3. ะัะฐะฒะธะปัะฝะฐั ะฐััะธัะตะบัััะฐ
- โ Resolver ัะพะดะตัะถะธั ัะพะปัะบะพ `useCase` (ัะตะฟะพะทะธัะพัะธะธ ัะดะฐะปะตะฝั)
- โ `NewResolver` ะฟัะธะฝะธะผะฐะตั ัะพะปัะบะพ `useCase`
- โ ะัะต ะทะฐะฒะธัะธะผะพััะธ ะฝะฐะฟัะฐะฒะปะตะฝั ะฒะฝัััั ะบ Domain

### 4. ะะพะฝะฒะตััะตัั ะฒ UseCase
- โ `entityToGraphQLUser()` - ะบะพะฝะฒะตััะธััะตั `*entity.User` โ `*model.User`
- โ `entityToGraphQLReport()` - ะบะพะฝะฒะตััะธััะตั `*entity.Report` โ `*model.Report`
- โ `entityToGraphQLCompetition()` - ะบะพะฝะฒะตััะธััะตั `*entity.Competition` โ `*model.Competition`

## ๐ ะัะฐะฒะธะปัะฝัะน ะฟะพัะพะบ ะทะฐะฒะธัะธะผะพััะตะน (Onion Architecture)

```
Presentation โ Application โ Domain โ Infrastructure
     โ              โ           โ            โ
     โ              โ           โ            โ
     โโโโโโโโโโโโโโโโดโโโโโโโโโโโโดโโโโโโโโโโโโโ
              ะัะต ะทะฐะฒะธััั ะพั Domain
```

**ะัะธะฝัะธะฟั**:
1. โ ะะฐะฒะธัะธะผะพััะธ ะฝะฐะฟัะฐะฒะปะตะฝั ะฒะฝัััั (ะบ ัะตะฝััั - Domain)
2. โ Domain ะฝะต ะทะฐะฒะธัะธั ะฝะธ ะพั ัะตะณะพ
3. โ Infrastructure ัะตะฐะปะธะทัะตั ะธะฝัะตััะตะนัั ะธะท Domain
4. โ Application ะธัะฟะพะปัะทัะตั ะธะฝัะตััะตะนัั, ะฐ ะฝะต ะบะพะฝะบัะตัะฝัะต ัะตะฐะปะธะทะฐัะธะธ
5. โ **Presentation ะธัะฟะพะปัะทัะตั ัะพะปัะบะพ Application (UseCase)** - ะฟะพะปะฝะพัััั ัะพะพัะฒะตัััะฒัะตั Onion Architecture

## ๐ฏ ะัะธัะตัะธะธ ะทะฐะฒะตััะตะฝะธั ะผะธะณัะฐัะธะธ

- [x] ะัะต resolver'ั ัะฐะฑะพัะฐัั ั entity ัะธะฟะฐะผะธ
- [x] ะกะพะทะดะฐะฝั ะบะพะฝะฒะตััะตัั entity โ GraphQL model
- [x] Resolver ะธัะฟะพะปัะทัะตั ะธะฝัะตััะตะนัั ัะตะฟะพะทะธัะพัะธะตะฒ
- [x] Backend ะบะพะผะฟะธะปะธััะตััั ะฑะตะท ะพัะธะฑะพะบ
- [x] Backend ะทะฐะฟััะบะฐะตััั ะธ ัะฐะฑะพัะฐะตั
- [x] **ะัะต ะผะตัะพะดั UseCase ัะตะฐะปะธะทะพะฒะฐะฝั**
- [x] **ะัะต ะผะตัะพะดั Resolver ะธัะฟะพะปัะทััั `r.useCase`**
- [x] **ะฃะดะฐะปะตะฝั ะฒัะตะผะตะฝะฝัะต ัะตะฟะพะทะธัะพัะธะธ ะธะท Resolver**
- [ ] ะัะต ัะตััั ะฟัะพัะพะดัั (ะตัะปะธ ะตััั)

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

- `docs/ARCHITECTURE.md` - ะพะฟะธัะฐะฝะธะต ะฐััะธัะตะบัััั
- `docs/MIGRATION_PROGRESS.md` - ะฟัะพะณัะตัั ะผะธะณัะฐัะธะธ ะผะตัะพะดะพะฒ

## โ ะัะฒะพะด

**Onion Architecture ะฟะพะปะฝะพัััั ัะตะฐะปะธะทะพะฒะฐะฝะฐ!** 

โ ะัะต ะผะตัะพะดั UseCase ัะตะฐะปะธะทะพะฒะฐะฝั  
โ ะัะต Resolver'ั ะธัะฟะพะปัะทััั UseCase  
โ ะะตะฟะพะทะธัะพัะธะธ ัะดะฐะปะตะฝั ะธะท Resolver  
โ ะัะฐะฒะธะปัะฝัะน ะฟะพัะพะบ ะทะฐะฒะธัะธะผะพััะตะน  
โ Domain ะฒ ัะตะฝััะต ะฐััะธัะตะบัััั  

**ะัะพะตะบั ะฝะฐ 100% ัะพะพัะฒะตัััะฒัะตั Onion Architecture!**
