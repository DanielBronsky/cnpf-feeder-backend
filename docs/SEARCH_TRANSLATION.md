# Многоязычный поиск (Русский ↔ Румынский)

## Описание

Система поиска поддерживает автоматический перевод и транслитерацию запросов между русским и румынским языками. Это позволяет находить результаты даже если запрос на одном языке, а данные на другом.

## Как это работает

### 1. Перевод ключевых слов

Система автоматически переводит ключевые слова из запроса:

**Примеры:**
- "соревнования" → ищет также: `competitie`, `competitii`, `etapa`, `etape`
- "отчет" → ищет также: `raport`, `raporturi`
- "чемпионат" → ищет также: `campionat`, `campionate`

### 2. Транслитерация названий мест

Кириллические названия автоматически транслитерируются:

**Примеры:**
- "Данчены" → ищет также: `danceni`, `dancheni`
- "Днестр" → ищет также: `dnestr`, `nistru`
- "барраж" → ищет также: `baraj`, `barajul`

### 3. Комбинированный поиск

Система генерирует все возможные варианты запроса и ищет по всем из них одновременно.

## Примеры использования

### Пример 1: Поиск соревнований

**Запрос на русском:**
```
"Соревнования на Данченах"
```

**Что ищет система:**
- `соревнования` + `на` + `данчены`
- `competitie` + `la` + `danceni`
- `etapa` + `pe` + `dancheni`
- И другие комбинации...

**Результат:** Находит соревнование "INTEGISTRARE la III Etapa a CM la feeder, editia 2025, lacul Danceni"

### Пример 2: Поиск отчетов

**Запрос на русском:**
```
"Отчет о Днестре"
```

**Что ищет система:**
- `отчет` + `о` + `днестр`
- `raport` + `despre` + `dnestr`
- `raport` + `despre` + `nistru`
- И другие комбинации...

### Пример 3: Поиск по названию места

**Запрос на русском:**
```
"Lacul Danceni"
```

**Что ищет система:**
- `lacul` + `danceni` (оригинал)
- `озеро` + `danceni` (обратный перевод)
- `lacul` + `данчены` (транслитерация)

## Добавление новых переводов

Чтобы добавить новые переводы, отредактируйте файл `internal/search/translation.go`:

```go
var translationMap = map[string][]string{
    "новое_слово": {"translation1", "translation2"},
    // ...
}
```

## Технические детали

### Алгоритм работы

1. **Расширение запроса**: Функция `ExpandQuery()` генерирует все варианты запроса
2. **Поиск по всем вариантам**: MongoDB ищет по всем сгенерированным вариантам одновременно
3. **Дедупликация**: Результаты дедуплицируются по ID, чтобы избежать дублей

### Производительность

- Поиск выполняется за один запрос к MongoDB
- Используется индексация MongoDB для быстрого поиска
- Ограничение результатов: максимум 5 результатов на тип (отчеты/соревнования)

## Ограничения

1. **Словарь переводов**: Система использует предопределенный словарь. Новые слова нужно добавлять вручную
2. **Точность транслитерации**: Транслитерация работает для стандартных случаев, но может не покрывать все варианты
3. **Контекст**: Система не учитывает контекст использования слов

## Рекомендации

1. **Добавляйте переводы**: По мере появления новых ключевых слов, добавляйте их в словарь
2. **Тестируйте**: Проверяйте поиск на реальных данных
3. **Мониторинг**: Отслеживайте, какие запросы не находят результаты, и добавляйте соответствующие переводы

## Примеры запросов для тестирования

```graphql
query {
  chat(query: "Соревнования на Данченах") {
    message
    results {
      id
      type
      title
      location
    }
  }
}
```

```graphql
query {
  chat(query: "Отчет о Днестре") {
    message
    results {
      id
      type
      title
    }
  }
}
```

```graphql
query {
  chat(query: "Lacul Danceni") {
    message
    results {
      id
      type
      title
      location
    }
  }
}
```
